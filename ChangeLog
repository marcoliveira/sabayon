2005-05-10  Sebastien Bacher  <seb128@debian.org>

	* admin-tool/sabayon-xinitrc.sh.in: fix a syntax error.

2005-05-09  Sebastien Bacher  <seb128@debian.org>

	* admin-tool/profilesdialog.py: use shutil.move instead of os.rename,
	fix the issue when /tmp and /etc are on different partitions.

2005-05-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/util.py: import errno module

2005-05-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/util.py:
	(uninterruptible_spawnv): actually call
	uninterruptible_spawnve() rather than os.spawnv

2005-05-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/usermod.py: don't import errno.
	
	* lib/util.py:
	(uninterruptible_spawnve): if env is None, call
	os.spawnv() since os.spawnve() seems to dislike
	when env is None.

2005-05-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/usermod.py: move _uninterruptible_spawn() to ..

	* lib/util.py:
	(uninterruptible_spawnv),
	(uninterruptible_spawnve): ... here
	
	* admin-tool/profilesdialog.py,
	  lib/protosession.py: use uninterruptible variant
	of os.spawnv() here too.

2005-05-09  Mark McLoughlin  <markmc@redhat.com>

	Fix hang when exiting the prototype session on Ubuntu.

	Problem turned out to be that os.spawn() doesn't handle
	EINTR from waitpid() on Linux:
	  http://sourceforge.net/tracker/?group_id=5470&atid=105470&func=detail&aid=686667

	Thanks to Sebastien Bacher <seb128@debian.org> for help
	in tracking the problem down. Bug #303034.

	* lib/usermod.py:
	(_uninterruptible_spawn): ignore EINTR from os.spawn()
	(set_shell), (set_homedir): use _uninterruptible_spawn()

	* lib/protosession.py:
	(ProtoSession.__session_child_watch_handler): emit the
	"finished" signal before anything else so that we
	still quit the mainloop even if we get an exception.

2005-04-26  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon-apply: actually look up the profile
	from userdb.

2005-04-11  Josep Puigdemont  <josep.puigdemont@gmail.com>

	* configure.ca: Added "ca" to ALL_LINGUAS.

2005-04-07  John Dennis  <jdennis@redhat.com>

	* Bookmark commit/sync/apply mostly working.
	  Is initial state correct?
	  Bookmark root and traversal needs reworking.
	  Many places now have redundant code that varies only
	  a few variables, these should be collapsed into subroutines.

2005-04-06  John Dennis  <jdennis@redhat.com>

	* bookmark changes now working

2005-04-01  Steve Murphy  <murf@e-tools.com>

        * configure.ac: Added "rw" to ALL_LINGUAS.

2005-03-31  John Dennis  <jdennis@redhat.com>

	* lib/util.py
	* lib/mozilla_bookmarks.py
	* lib/sources/mozillasource.py

	Fix traversal order problem, traversal order is now identical to
	originial bookmark order.

	Move DictCompare from mozillasource.py to util.py so it can be shared.
	
2005-03-31  John Dennis  <jdennis@redhat.com>

	* lib/mozilla_bookmarks.py
	* lib/sources/mozillasource.py

	Initial "glue" to wed together mozilla_bookmarks and mozillasource.
	Mozillasource now monitors and creates a bookmark object.
	Remove obsolete ununsed code
	Clean up home_dir initialization
	Mozilla_bookmarks now python stand alone for testing, not sh standalone
	Can now compare and generate differences between two bookmark files.
	Can now write out bookmark file from data structure (note, the 
	original ordering is not fully preserved, this needs to be fixed.
	Attributes written out can now be filtered.
	Rework add_file method.
	
2005-03-30  John Dennis  <jdennis@redhat.com>

	* lib/mozilla_bookmarks.py: Add new python file for mozilla
	bookmarks. Not complete yet, it can parse DOCTYPE
	NETSCAPE-Bookmark-file-1 format file, build a data structure of
	folder trees, bookmarks, and all attributes. Folders and bookmarks
	can be searched for.

	ToDo: Generate the difference between two book mark files, this
	will use the same difference generator code currently in
	mozillasource. Merge one bookmark file into another. Integrate
	into monitor and apply. Filter attributes during apply that should
	not be merged (e.g. timestamps)

Sat Mar 26 17:37:45 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.ac: applied patch from Joshua Hoblitt to add Gentoo support

2005-03-24  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: post-release bump to 0.18.

==================== 0.17 ====================

2005-03-24  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: Version 0.17.
	
2005-03-24  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: add --with-prototype-user=<username>,
	defaults to "sabayon"
	
	* lib/Makefile.am, lib/config.py.in: set PROTOTYPE_USER
	to whatever was passed to configure.
	
	* sabayon.spec.in: use --with-prototype-user.
	
	* doc/site.xsl: add link to Fedora Extras repository.
	
	* doc/*.html: rebuild.

2005-03-23  John Dennis  <jdennis@redhat.com>

	* lib/userprofile.py: add start_monitoring and stop_monitoring to
	the Delegate class, and invoke them.

	* lib/paneldelegate.py: add start_monitoring and stop_monitoring
	stub routines
	
	* lib/util.py: Add ability for a modules debug flag to be a hex
	mask. Thus debug output can be limited not only to specific
	modules, but also to specific classes of debug messages in a
	module. See usage in mozilla-source.py.

	* lib/sources/mozilla-source.py: Fix the two major bugs
	outstanding, the union of all profile changes are appled to all
	target profiles instead of a one-to-one profile merge and the
	initial state is correctly set at the beginning of monitoring so
	that we detect what has changed. Clean up path handling. Implement
	debug logging according to class of message. Remove the source and
	delegate from the JavascriptPrefFile class. Add code to load the
	state, used at beginning of monitoring. Added support for
	start_monitoring. Removed other attempts to load file state during
	apply and delegate construction. During sync_change take the union
	of all profile changes and store these in the firefox directory,
	not in the profile directory. Then have apply() merge this one set
	of changes stored in the storage module to all target profiles.

2005-03-22  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: add BuildRequires: usermode

2005-03-22  Mark McLoughlin  <markmc@redhat.com>

	Patch from Alak Trakru <atrak@eden.rutgers.edu>

	* configure.ac: add slackware support.

2005-03-21  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: couple more minor fixes.

2005-03-21  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: lots of changes from Fedora Extras
	review.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: add BuildRequires: gettext-devel
	and add X-Fedora-Extra to .desktop file.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: post-release bump to 0.17.
	
==================== 0.16 ====================

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: Version 0.16.
	
2005-03-18  Mark McLoughlin  <markmc@redhat.com>
	
	* lib/userprofile.py: import sources from the
	sources module.
	
	* lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/sources/mozillasource.py,
	  lib/sources/paneldelegate.py,
	  lib/sources/testsource.py: import the
	various sabayon python modules from the
	sabayon namespace instead of expecting
	them to be in the toplevel namespace.

	* lib/sources/__init__.py: module init script
	for the sources module.
	
	* lib/sources/Makefile.am: install __init__.py

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: fix blooper.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/editorwindow.py: fix problems with displaying
	empty profiles.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: hopefully fix problem	which
	was causing obstuse "@INTLTOOL_PERL@: bad interpreter"
	error messages.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: forgot some fixes.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	Re-work the way we install all the python stuff to
	bring us in line with normal conventions.

	* admin-tool/Makefile.am: install the python files
	in libdir/python/site-packages/sabayon, remove the
	wrapper scripts and install the python main scripts
	in sbindir/libexec etc.
	
	* admin-tool/sabayon: renamed from sabayon.py

	* admin-tool/sabayon-apply: renamed from sabayon-apply.py.
	
	* admin-tool/sabayon-monitor: renamed from sabayon-monitor.py.
	
	* admin-tool/sabayon-session: renamed from sabayon-session.py.
	
	* lib/Makefile.am: install __init__.py and install
	python files in libdir/python/site-packages/sabayon.
	
	* lib/__init__.py: empty module init script.
	
	* lib/config.py.in: remove GLADEDIR and MODULEPATH foo.
	
	* lib/dirmonitor.py: make the unit tests pass.
	
	* lib/sources/Makefile.am: change install locatio of python
	files.
	
	* lib/userprofile.py: re-work the module loader to figure
	out the module load path itself at runtime.
	
	* sabayon.spec.in: package the python stuff according
	to Fedora Extras guidelines.

2005-03-18  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: go back to using shadow-utils instead
	of fedora-usermgmt as there doesn't actually seem to be
	consensus around using fedora-usermgmt.

2005-03-17  John Dennis  <jdennis@redhat.com>

	* remove redundant pref file writing method, fix use of
	"enumerations", fix initial and subsequent loading of ini file,
	fix several bugs that confused absolute paths and relative paths,
	fix the copying of key/values from an extracted pref file to an
	instantiated pref file, fix how types determined and passed, fix
	the creation of the sabayon pref file in storage, if no ini file
	exists in the target extract the ini file that is in storage,
	parse the ini after we've determined if we using the stored one or
	the user's target version, iterate over every profile defined in
	the ini and apply the preferences from storage, fix the ordering
	of target application so that ini's come first, then prefs, then
	bookmarks, then other files, make sure directories exist before
	trying to write a file.

	* Still need to do: Need to reparse the everything after the apply
	and before monitoring happens. Currently prefs are merged
	one-to-one with profiles, it should be the default is merged to
	all profiles.

Thu Mar 17 22:44:53 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/userdb.py: adding saving back on changes.

Thu Mar 17 10:03:50 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/userdb.py: remove a couple of bugs

Wed Mar 16 19:40:03 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/userdb.py lib/util.py po/POTFILES.in: implementation of userdb,
	  doesn't write back on changes yet.

2005-03-16  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: subst a subdir of sysconfdir
	for xinitrc rather than using sysconfdir
	directly.

	* admin-tool/Makefile.am: upd. for above change.
	Needed because sysconfdir may be passed as an
	argument to make itself.

	* sabayon.spec.in: changes to bring in line with
	Fedora guidelines. Most notable change is that
	it uses the fedora-usermgmt scripts for creating
	users.
	Note, the uid/gid will need to be registered somewhere
	like http://www.fedora.us/wiki/PackageUserRegistry

2005-03-16  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: add userswindow.py
	
	* lib/Makefile.am: add userdb.py

2005-03-16  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/userswindow.py: fix silly.

2005-03-16  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: set $DISABLE_SABAYON_XINITRC
	when running our protosession.
	
	* admin-tool/sabayon-xinitrc.sh.in: don't run
	sabayon-apply if $DISABLE_SABAYON_XINITRC is set.
	
	* lib/userdb.py: add silly impl. of the stubs for
	testing.

2005-03-16  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: set XINITRCDIR and INSTALL_XINITRC_SCRIPT
	on Fedora.
	
	* admin-tool/sabayon-xinitrc.sh.in: add xinitrc script
	to run sabayon-apply at login.
	
	* admin-tool/Makefile.am: install sabayon-xinitrc.sh.

2005-03-15  John Dennis  <jdennis@redhat.com>

	* Expand mozilla functionality. The MozillaChange class has more
	info. An individual pref in a javascript file is now its own
	class. We now recognize the different javascript pref functions
	and record them. We now have two new functions for writing a
	javascript pref file. More get_* functions for various
	classes. commit_changes now respect mandatory flag and cache
	committed preferences for later processing. The default profiles
	prefs.js is now added to the profile (but I'm not sure thats the
	right thing to do, but it had to exist for testing, I'll revisit
	this). apply now knows the difference between javascript
	preference files and other files. apply now merges javascript
	prefs into the default profile's prefs.js respecting the mandatory
	flag. 

	Issues: What to do with multiple firefox profiles? At the moment
	we only apply to the default firefox profile. Perhaps the apply
	should occur for all firefox profiles, not just the default. By
	the same token should the recorded preferences be the union of all
	changed profiles or just the default? If its the union which one
	wins when there is an overlap? There may be ordering problems with
	the apply, the profiles.ini file should exist first, and then the
	prefs.js file, before merging occurs. Nothing at the moment
	enforces this ordering (we've been lucky). Should we take
	advantage of the user.js file instead of merging into prefs.js? We
	sometimes fail to recognize there is a profiles.ini file which
	controls many important functions. If we don't know its there we
	fail to recognize files we need to watch because that file defines
	where profiles live. At the moment I think this is due to ordering
	relationship between class creation (one place we look for the
	file), the apply extraction of that file, and the subsequent file
	monitoring. Probably fix is to create the profiles ini object
	after apply extraction of the file.

2005-03-15  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon-apply.py: add some commented out
	code to hook up to userdb in order to find the profile
	for the current user.

2005-03-15  Mark McLoughlin  <markmc@redhat.com>

	Partial fix for bug #170280

	* admin-tool/monitorwindow.py: just print a traceback
	if commit_change() fails and continue committing remaining
	changes.

2005-03-15  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py: fix minor problems with Will's patch.

2005-03-14  William Lachance <wrlach@gmail.com>

	* configure.ac: Not finding xnest should be a warning, not an error. 
	Check for distro, and set path to Xsession accordingly (bug #168123).

	* lib/config.py.in: Don't hard code Xsession, make it a build-time
	option.

	* lib/Makefile.am: Substitute the Xsession variable appropriately.

	* lib/storage.py: Actually give the filename that's not found upon
	a ProfileStorageException.

2005-03-14  John Dennis  <jdennis@redhat.com>

	* rework mozillasource so code and class structure better supports
	file creation, file apply, etc. The profiles.ini file is now added
	and applied to the storage, as well as a sabayon prefs.js
	file. Other files under the profile directory are analyzed if they
	should be added to the storage for each profile. At the moment
	only prefs.js and bookmarks.html are stored under the
	profile. Next is to correctly merge these during the apply phase.

2005-03-14  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/userswindow.py: add cheesy UI which uses
	userdb.py

2005-03-14  Mark McLoughlin  <markmc@redhat.com>

	* lib/userdb.py: add stub for DV to hack on.

Sun Mar 13 08:11:04 CET 2005 Daniel Veillard <veillard@redhat.com>

	* po/POTFILES.in: added admin-tool/fileviewer.py

2005-03-11  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon.png: new icon from Diana.

2005-03-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/userprofile.py:
	(SourceDelegate.sync_changes),
	(SourceDelegate.apply): add stubs for these delegate
	methods.
	(UserProfile.apply): invoke sync_changes() on each
	of the delegates after invoking it on the source.
	
	* lib/sources/mozillasource.py:
	(MozillaDelegate.sync_changes),
	(MozillaDelegate.commit_change),
	(MozillaDelegate.apply): add empty stubs.
	
	* lib/sources/paneldelegate.py:
	(PanelDelegate.sync_changes): add empty stub.

Thu Mar 10 16:39:38 CET 2005 Daniel Veillard <veillard@redhat.com>

	* doc/site.xsl doc/*.html: updated the source tarball download link

2005-03-10  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: post-release bump to 0.16.

==================== 0.15 ====================

2005-03-10  Mark McLoughlin  <markmc@redhat.com>

	* configure.in: Version 0.15.
	
2005-03-10  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/fileviewer.py: an even cheesier
	text file viewer to go along with the cheesy
	GConf viewer.
	
	* admin-tool/Makefile.am: add fileviewer.py
	
	* admin-tool/editorwindow.py: hook it up.

2005-03-09  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/gconfviewer.py: cheesy view-only
	gconf-editor type thing.
	
	* admin-tool/Makefile.am: add gconfviewer.py
	
	* admin-tool/editorwindow.py: show the GConf
	viewer when a GConf element is activated.
	
	* lib/sources/gconfsource.py: fix silly.

2005-03-09  Mark McLoughlin  <markmc@redhat.com>
	
	* lib/userprofile.py:
	(ProfileSource.get_path_description): add stub for
	sources to implement giving descriptions for their
	paths.
	(UserProfile.get_source): lookup a source by name.
	
	* lib/sources/filessource.py:
	(FilesSource.get_path_description): return
	a description for menu files.
	
	* lib/sources/gconfsource.py:
	(GConfSource.get_path_description): return
	descriptions for .gconf.xml.defaults and
	.gconf.xml.mandatory.
	
	* admin-tool/editorwindow.py: Display the description
	for the path rather than the path itself.

2005-03-08  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py:
	(ProfileStorage.revert): set the prefix correctly
	on the temporary directory.

2005-03-08  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/editorwindow.py: add a combo box for each
	element in the list to allow you to revert to previous
	versions of files or directories.

2005-03-08  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py: bah, fix other place where timestamp
	was being saved as a date string.

Tue Mar  8 14:55:42 CET 2005 Daniel Veillard <veillard@redhat.com>

	* doc/flat.html doc/testing.html: fix a small formatting glitch
	  before pushing live

2005-03-07  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py:
	(ProfileStorage.get_source),
	(ProfileStorage.revert): implement.
	(run_unit_tests): yet more unit tests.
	
	* admin-tool/editorwindow.py: allow reverting to
	previous versions of the profile.

2005-03-07  Mark McLoughlin  <markmc@redhat.com>

	This commit changes the metadata format again.

	* lib/storage.py: save a timestamp rather than date
	string for each revision.
	
	* admin-tool/editorwindow.py: format the timestamp
	according to the locale.
	
	* lib/util.py:
	(init_gettext): call setlocale()

Mon Mar  7 16:08:23 CET 2005 Daniel Veillard <veillard@redhat.com>

	* doc/Makefile.am: added validation of output pages on rebuild
	  and package them in the distrib
	* sabayon.spec.in: add the web informations as documentation

Mon Mar  7 15:45:12 CET 2005 Daniel Veillard <veillard@redhat.com>

	* Makefile.am configure.ac doc/Makefile.am: integrating the doc
	  subdir with the site/doc informations. The "make rebuild" target
	  rebuilds the web site
	* doc/brownbar.jpg doc/brownbarTop.jpg doc/sabayon.css doc/shadow.gif
	  doc/title01.jpg doc/title02.jpg: new web site design from
	  Diana Fong and Bryan Clark
	* TODO site.xsl flat.html: converted the web site generation to
	  a raw content flat file and an XSLT stylesheet generating the
	  html pages. Separation of content and presentation, except the
	  content of the boxes on the left is contained in the stylesheet,
	  but they should stll be easy to maintain.

2005-03-07  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/editorwindow.py: add a combo to allow
	selecting the profile revision.
	
	* lib/storage.py:
	(ProfileStorage.get_revision): return the date along
	with the revision in a tuple.

Sun Mar  6 11:49:38 CET 2005 Daniel Veillard <veillard@redhat.com>

	* po/POTFILES.in: added admin-tool/aboutdialog.py to avoid automated
	  mail stating it is missing.

2005-03-04  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/editorwindow.py: convert to using
	gtk.UIManager.
	
	* admin-tool/sabayon.glade: remove the editor
	window.

2005-03-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: add saveconfirm.py

	* admin-tool/saveconfirm.py: HIG save confirmation
	dialog. Mostly copied from GEdit.
	
	* admin-tool/editorwindow.py: hook up the save
	confirmation dialog.

2005-03-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon.glade: add a "Delete" menu item.
	
	* admin-tool/editorwindow.py:
	(ProfileModel.reload): implement reloading the model.
	(ProfileEditorWindow.__handle_key_press),
	(ProfileEditorWindow.__handle_delete): hook up the
	delete key and menu item.
	
	* admin-tool/profilesdialog.py:
	(ProfilesDialog.__handle_key_press): hook up the
	delete key.

2005-03-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon.glade: add a "Clear History"
	menu item.
	
	* admin-tool/editorwindow.py: hook up "Clear History"
	and "Save".
	
	* lib/storage.py:
	(ProfileStorage.clear_revisions): implement clear
	revision history.
	(run_unit_tests): add tests for clearing revision
	history.

2005-03-02  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/editorwindow.py: add a silly little
	placeholder viewer for the contents of the profile.
	Lots more work to be done here.
	
	* admin-tool/profilesdialog.py: add a "Properties"
	button and hook up the editor window.
	
	* admin-tool/sabayon.glade: add the properties button
	and the editor window.
	
	* admin-tool/Makefile.am: add editorwindow.py

2005-03-02  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py: move about dialog
	stuff to
	
	* admin-tool/aboutdialog.py: here.
	
	* admin-tool/Makefile.am: add aboutdialog.py

2005-03-01  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/filessource.py:
	(commit): set the "mandatory" attribute correctly.
	
	* lib/sources/gconfsource.py:
	(apply): fix check to see if the GConf dirs are in
	the profile storage.

2005-03-01  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py:
	(__item_revision_is_current): return false if no
	current revision.
	(__unpack): create the revisions directory. Use the
	list of files and directories in the metadata to
	figure out what to unpack. Fixes problems with adding
	empty dirs.
	(add): don't copy previous revision if it doesn't
	exist.
	(save.zip_directory): remove unused param.
	(save): consolidate duplicate code paths
	
	* lib/sources/gconfsource.py:
	(sync): only add directories to storage if they exist.
	(apply): only extract directories if they exist.
	
	* lib/sources/filessource.py: don't pre-format the
	debugging string since the path can contain '%'
	
	* lib/sources/paneldelegate.py: ditto.

2005-03-01  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py: fix spelling error pointed out
	by Adam Weinberger <adamw@gnome.org> in bug #168843

2005-02-28  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py: fix bug with cancel
	on the new profile dialog.
	
	* lib/config.py.in: move the Xnest window name to
	
	* lib/protosession.py: here so we don't try and
	reference _() before its defined.
	
	* lib/storage.py: add a needs_saving flag so that
	saving an empty and non-existant profile works.

2005-02-28  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py:
	(__create_new_profile): upd to use new ProfileStorage
	API.
	
	* admin-tool/monitorwindow.py,
	  admin-tool/sabayon-apply.py,
	  admin-tool/sabayon-session.py,
	  admin-tool/sabayon-monitor.py: pass about
	the profile name instead of the profile path.
	
	
	* lib/storage.py: allow a profile name to be an
	absolute path. Kill "running_unit_tests" hack.
	
	* lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/userprofile.py:
	(run_unit_tests): fix to work with new ProfileStoage
	API.
	
	* lib/README.storage: remove, its out of date
	and we've inline docs now.

2005-02-28  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py:
	(__handle_about): add translator credits.

2005-02-28  Mark McLoughlin  <markmc@redhat.com>

	i18nize the python code and construct paths
	with os.path.join()

	* lib/util.py:
	(init_gettext): add function to call gettext.install()
	
	* admin-tool/sabayon-apply.py,
	  admin-tool/sabayon-monitor.py,
	  admin-tool/sabayon-session.py,
	  admin-tool/sabayon.py: call util.init_gettext()
	
	* lib/Makefile.am: subst some more variables into
	config.py.
	
	* lib/config.py.in: add PACKAGE and use os.path.join()
	
	* admin-tool/monitorwindow.py,
	  admin-tool/profilesdialog.py,
	  lib/dirmonitor.py,
	  lib/protosession.py,
	  lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/sources/mozillasource.py,
	  lib/sources/paneldelegate.py,
	  lib/storage.py,
	  lib/unittests.py: i18nize and use os.path.join()

2005-02-28  Alexander Shopov  <ash@contact.bg>

	* configure.in: Added "bg" (Bulgarian) to ALL_LINGUAS

2005-02-25  Mark McLoughlin  <markmc@redhat.com>

	This commit breaks any existing profiles. The metadata
	format has changed.

	Also, the code in admin-tool still needs to be fixed
	up to made work with this stuff. All the unit tests
	pass, though.

	* lib/storage.py: substantially re-work to add revision
	history and make the API more useful.

	* lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/sources/mozillasource.py,
	  lib/sources/paneldelegate.py,
	  lib/sources/testsource.py,
	  lib/userprofile.py: Fixup to use the new ProfileStorage
	API.
	
	* lib/config.py.in: add .gconf.xml.defaults and
	.gconf.xml.mandatory to the list of dirs to ignore.
	
Tue Feb 22 03:10:20 CET 2005 William Lachance <wlach@nit.ca>

	* autogen.sh configure.ac: Properly check for xnest #168124
	
Mon Feb 21 11:48:20 CET 2005 Daniel Veillard <veillard@redhat.com>

	* doc/helping.html: one more Evince->Sabaon cleanup bug #168000

2005-02-20  Kostas Papadimas <pkst@gnome.org>

	* configure.ac: Add el (Greek) to ALL_LINGUAS

Sun Feb 20 00:47:20 CET 2005 Daniel Veillard <veillard@redhat.com>

	* doc/developing.html doc/helping.html doc/index.html: more fixes
	  of links, etc. on the web site.

Sun Feb 20 00:23:00 CET 2005 Daniel Veillard <veillard@redhat.com>

	* TODO: small update

Sun Feb 20 00:11:09 CET 2005 Daniel Veillard <veillard@redhat.com>

	* doc/developing.html doc/helping.html doc/index.html doc/sabayon.css
	  doc/testing.html doc/images/screenshot.png: build a preliminary
	  web page based on Evince one.

2005-02-18  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.ac: Add «nb» and «no» to ALL_LINGUAS

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: kill the xmlsoft.org url :)

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: post-release bump to 0.15.

==================== 0.12 ====================

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: Version 0.12.

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* sabayon.spec.in: copy GDM's method of creating 
	the sabayon user.

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: post-release bump to 0.12.

==================== 0.11 ====================

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: Version 0.11.

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon.glade: remove the splitter
	for now - we're not using the text view yet.
	
	* lib/config.py.in: add ADMIN_TOOL_TIMEOUT
	
	* lib/protosession.py: and use it here.
	
	* lib/sources/gconfsource.py:
	(GConfChange): store the key and value rather
	than the entry so we can unset the value if
	we wish.
	
	* lib/sources/paneldelegate.py: upd.
	
	* sabayon.spec.in: create /etc/gconf/2/local-defaults.path
	and /etc/gconf/2/local-mandatory.path

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: clobber all process running
	as the prototype user before starting the new session.
	
	* lib/config.py.in: add CLOBBER_USER_PROCESSES

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/gconfsource.py:
	(GConfSource.sync): recursively add all the files
	in the GConf database to the ProfileStorage.
	(GConfSource.apply): copy the GConf database out
	from the ProfileStorage temporary install location.
	
	* lib/sources/filessource.py: fix typo.
	
	* lib/util.py:
	(debug_print): only take a pre-formatted string.
	
	* lib/storage.py:
	(ProfileStorage.delete_file): use list.remove() instead
	of non-existant	list.delete()
	(ProfileStorage.install): change the prefix for the
	temporary dir.

2005-02-17  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/gconfsource.py: add some debugging.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* lib/config.py.in: upd Xnest command line.
	
	* lib/sources/filessource.py: fix typos.
	
	* sabayon.spec.in: don't set the homedir to
	/var/sabayon - we don't use that anymore.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* lib/userprofile.py:
	(ProfileChange): kill get_name(), get_type() and
	get_value(). Add get_id() and get_short_description().
	
	* lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/sources/mozillasource.py,
	  lib/sources/paneldelegate.py,
	  lib/sources/testsource.py: impl. new functions.
	
	* admin-tool/monitorwindow.py: update for ProfileChange
	changes.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py: change things around
	a bit so that we lose some of the columns in the list
	and the commit menu item. Now everything gets saved
	by default unless you toggle the "ignore" button for
	the change.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon.glade: add an about menu item.
	
	* admin-tool/monitorwindow.py: hook up the about
	dialog.
	
	* admin-tool/profilesdialog.py: set the window icon.
	
	* lib/Makefile.am, lib/config.py.in: add VERSION to
	the config.
	
	* lib/usermod.py: add a FIXME.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py: hook up "Base on" by
	just copying the profile we're basing the new one on.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* lib/config.py.in: add PROTOTYPE_USER.
	
	* admin-tool/profilesdialog.py: use it here.

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* lib/config.py.in: add SKEL_HOMEDIR.
	
	* lib/usermod.py:
	(create_temporary_homedir): copy the contents of
	/etc/skel when creating the homedir.
	
	* lib/protosession.py:
	(__start_session): fix uid/gid mixup
	(__setup_shell_and_homedir):
	use usermod.create_temporary_homedir()

2005-02-16  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: create a temporary homedir
	before starting the session and delete it after.
	
	* lib/usermod.py:
	(set_shell), (set_homedir): split these out
	into their own module. We'll prolly need to
	implement them differently for other distros.

	* lib/Makefile.am: add usermod.py.
	
	* lib/util.py: add usermod debugging.
	
	* lib/config.py.in: re-name/re-organize a few things.
	
	* lib/dirmonitor.py: add IO_PRI to the io_watch and
	fill in the other arguments in the callback.

2005-02-15  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/paneldelegate.py: fix typo.

2005-02-15  Mark McLoughlin  <markmc@redhat.com>

	* configure.ac: subst the expanded value of
	$(sbindir) and output sabayon.console. Hack copied
	from gdm. 

	* admin-tool/Makefile.am: don't build sabayon.console here.
	
	* admin-tool/sabayon.console.in: use $(EXPANDED_SABAYON_DIR)
	
	* lib/sources/Makefile.am: install in the right directory.
	
	* sabayon.spec.in: update to include icon, .desktop file,
	usermode stuff, localizations etc.

2005-02-15  Mark McLoughlin  <markmc@redhat.com>

	* Makefile.am,
	  admin-tool/Makefile.am: distcheck fixes.

2005-02-15  Mark McLoughlin  <markmc@redhat.com>

	Applying seems to actually work now ...

	* admin-tool/sabayon-apply.in,
	  admin-tool/sabayon-apply.py: add tool which applies
	a profile.
	
	* admin-tool/Makefile.am: add sabayon-apply.
	
	* lib/config.py.in: s/SESSION_TOOL_PATH/SESSION_TOOL_ARGV/
	and add APPLY_TOOL_ARGV.
	
	* lib/protosession.py: run sabayon-apply instead of
	trying to do it directly.
	
	* admin-tool/profilesdialog.py: use SESSION_TOOL_ARGV
	instead of SESSION_TOOL_PATH.

2005-02-14  Mark McLoughlin  <markmc@redhat.com>

	* lib/config.py.in: add a list of env variables
	which should be passed through unmodified when
	starting the prototype session. Include SABAYON_DEBUG
	in the list.
	
	* lib/protosession.py: use the list here.
	
	* lib/dirmonitor.py: add debug spew, fix a bug
	with ignorationism.
	
	* lib/sources/filessource.py,
	  lib/sources/paneldelegate.py,
	  lib/storage.py,
	  lib/userprofile.py: more debug spew.
	
	* lib/util.py: add pid to debug spew.
	
	* admin-tool/monitorwindow.py,
	  admin-tool/profilesdialog.py: yet more spewage.

2005-02-14  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py,
	  lib/sources/mozillasource.py,
	  lib/sources/paneldelegate.py: hook up debugging.

2005-02-14  Mark McLoughlin  <markmc@redhat.com>

	* lib/util.py: (debug_print): add "admin-tool" key.

	* admin-tool/profilesdialog.py: hook up debugging.
	
	* lib/protosession.py: ditto.
	
2005-02-14  Mark McLoughlin  <markmc@redhat.com>
	
	* lib/protosession.py: pass the profile file
	to sabayon-monitor when launching it.
	
	* admin-tool/sabayon-monitor.py: barf if we're
	not passed an argument
	
2005-02-14  Mark McLoughlin  <markmc@redhat.com>

	Add a SABAYON_DEBUG env variable. Run with
	SABAYON_DEBUG=help to see allowable values.

	* lib/util.py: add debug_print() foo.
	
	* lib/storage.py: use it here.

2005-02-14  Mark McLoughlin  <markmc@redhat.com>

	Try to fix the build mess.
	
	* configure.ac: 
	Use AM_PATH_PYTHON instead of random copied and pasted
	crackrock.
	Add --enable-consolehelper and check for PAM prefix. Both
	copied from GDM.
	
	* admin-tool/Makefile.am:
	Use the SCRIPTS primary for the wrapper scripts and the
	PYTHON primary for python files.
	Generate sabayon.console so we get the right path.
	Copy GDM's consolehelper install stuff.
	
	* admin-tool/sabayon.console.in: copy from sabayon.console.
	
	* lib/Makefile.am,
	  lib/sources/Makefile.am: use the PYTHON primary for
	python files.

2005-02-13  David Lodge <dave@cirt,net>

	* configure.ac: Added en_GB to ALL_LINGUAS.

2005-02-13  Seth Nickell  <seth@gnome.org>

	* admin-tool/sabayon.glade:

	Don't require GNOME (causes lots of debug warnings at
	sabayon startup).
	
	* lib/sources/gconfsource.py:

	Change self.get_committing_client() call to the function name
	as implemented: self.get_committing_client_and_address().
	Fixes error when committing GConf keys.

2005-02-13  Seth Nickell  <seth@gnome.org>

	* admin-tool/Makefile.am:
	* admin-tool/sabayon.desktop.in: 

	Initial .desktop file for Sabayon
	
	* admin-tool/sabayon.png: 

	Placeholder icon...10 bonus points if you can tell what it is
	
	* admin-tool/sabayon.console:
	* admin-tool/sabayon.pam:

	consolehelper magic so sabayon can be run from GNOME w/o
	being root already.

2005-02-13  Seth Nickell  <seth@gnome.org>

	* admin-tool/profilesdialog.py:

	Throw up an explanatory (but not helpful...) error alert if the 
	sabayon user account does not exist. We should really offer to
	create it.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	Add first cut of "stuff to ignore" list.

	* lib/dirmonitor.py:
	(DirectoryMonitor.set_directories_to_ignore),
	(DirectoryMonitor.set_files_to_ignore): impl.
	(DirectoryMonitor.__handle_gamin_event),
	(DirectoryMonitor.monitor_dir): ignore stuff.
	(run_unit_tests): test out new foo.
	
	* lib/config.py.in: add lists of files and directories
	to ignore.
	
	* lib/sources/filessource.py: hook up lists.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/paneldelegate.py: fix typo.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/userprofile.py:
	(UserProfile.apply): call apply() on all delegates
	for each source too.
	
	* lib/sources/paneldelegate.py:
	(PanelDelegate.apply): add - it doesn't need to do anything, though.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/gconfsource.py:
	(recursive_unset): add - it turns out gconf_client_recursive_unset()
	isn't wrapped either.
	
	* lib/sources/paneldelegate.py:
	(PanelDelegate.__commit_removed_changed): make it work.
	(run_unit_tests): make sure committing is actually doing something.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/config.py.in: add PANEL_KEY_BASE.
	
	* lib/sources/paneldelegate.py: use it, instead of hardcoding
	/apps/panel - older versions use /apps/panel/profiles/default.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/gconfsource.py:
	(associate_schema): gconf_engine_associate_schema() isn't wrapped, so
	use gconftool to do the job.
	(get_client_and_address_for_path): we want the address rather than
	engine now.
	
	* lib/sources/paneldelegate.py:
	(PanelDelegate.__handle_id_list_change): remove all the added/removed
	functions and do it generically here.
	(PanelDelegate.__copy_dir): implement.
	(PanelDelegate.__commit_removed_change),
	(PanelDelegate.__commit_added_change): use our cache of the id list
	rather than the schema default when committing the id list.
	(run_unit_tests: put Humpty together again.

2005-02-11  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/gconfsource.py:
	(GConfSource.__get_client): rename to get_committing_client()
	and export. Also make it return a (client, engine) tupple.
	
	* lib/sources/paneldelegate.py:
	Store cached panel configuration in objects rather than tupples.
	Add added/removed flags for each panel/applet etc. If an applet
	has been added or removed, but that change not yet committed
	then these flags are set.
	(PanelDelegate.handle_change): filter out any changes to not
	yet committed added/removed panel/applets etc.
	(PanelDelegate.commit_change): first cut impl. Needs finishing,
	though.
	(run_unit_tests): update.

Thu Feb 10 18:33:48 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/config.py.in: added shell and usermod entries
	* lib/protosession.py: added set/reset shell methods

2005-02-10  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/paneldelegate.py: make the unit tests
	run again.

2005-02-10  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: add wrappers to distclean.

2005-02-10  Mark McLoughlin  <markmc@redhat.com>

	Add ability for delegates to commit changes.

	* lib/userprofile.py:
	(ProfileChange.__init__): allow a delegate to be
	passed to the constructor.
	(SourceDelegate.__init__): kill the "changes class" idea.
	(SourceDelegate.commit_change): add hook for delegates
	to implement.
	(ProfileSource.commit_change): if a change is associated
	with a delegate, commit the change via the delegate.
	
	* lib/sources/filessource.py:
	(FilesSource.commit_change): chain up to ProfileSource.commit_change.
	
	* lib/sources/gconfsource.py:
	(GConfSource.commit_change): ditto.
	
	* lib/sources/paneldelegate.py: associate changes with the delegate
	and add a commit_change() stub. Just need to figure out how in hell
	to do it now.

Thu Feb 10 13:30:58 CET 2005 Daniel Veillard <veillard@redhat.com>

	* ISSUES Makefile.am TODO sabayon.spec.in: added an ISSUES file
	  listing the open questions we need feedback on, added to
	  dist and spec file.

Thu Feb 10 12:49:53 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/Makefile.am: cosmetic cleanup
	* admin-tool/Makefile.am: making sure the desktop-profiles dir
	  is created
	* admin-tool/profilesdialog.py: renamed user to sabayon from protouser
	* Makefile.am sabayon.spec.in: added make rpm target as it's far
	  more convenient right now

Thu Feb 10 12:05:38 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/Makefile.am: make sure we clean up and rebuild config.py

Thu Feb 10 11:22:18 CET 2005 Daniel Veillard <veillard@redhat.com>

	* admin-tool/Makefile.am lib/Makefile.am lib/config.py.in:
	  moving sabayon-session and sabayon-monitor to @libexecdir@
	  since they should not be launched directly

Thu Feb 10 10:57:20 CET 2005 Daniel Veillard <veillard@redhat.com>

	* TODO: docs and man page

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py:
	(edit_button_clicked): copy the profile for
	the prototype session and copy it back when
	finished.
	(create_new_profile): remove hackiness.
	
	* lib/sources/gconfsource.py: don't import
	tempfile and shutil, not needed.

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/config.py.in: add path to sabayon-session.
	
	* admin-tool/profilesdialog.py: use it.

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/Makefile.am,
	  lib/config.py.in: sabayon-monitor is currently
	installed in sbindir, not bindir.

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/sabayon-session.py: import os module.

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py:
	(open_x_connection): absolutely horrendous hack to
	have a child process hold open a dummy X connection
	on Xnest.
	(main): remove - its been moved to sabayon-session.
	
	* lib/config.py.in: upd for admin-tool renaming.

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* lib/Makefile.am: add protosession.py

2005-02-09  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: add sabayon-monitor and
	sabayon-session.
	
	* admin-tool/profilesdialog.py:
	(edit_button_clicked): run sabayon session since
	ProtoSession has problems if there's an existing
	X display already open.
	(create_new_profile): temporary hack to make the profile
	writable by the prototype user. Will fix soon.
	
	* admin-tool/sabayon-monitor.in,
	  admin-tool/sabayon-monitor.py: re-name sabayon to
	sabayon-monitor.
	
	* admin-tool/sabayon-session.in,
	  admin-tool/sabayon-session.py: script to run a
	prototype session.
	
	* admin-tool/sabayon.py: launch the profiles editor
	from here.
	
	* admin-tool/profilesdialog.in: remove

Tue Feb  8 17:12:02 CET 2005 Daniel Veillard <veillard@redhat.com>

	* admin-tool/.cvsignore admin-tool/Makefile.am
	  admin-tool/profilesdialog.in: adding a wrapper shell for
	  profilesdialog too

2005-02-08  Mark McLoughlin  <markmc@redhat.com>

	* lib/sources/Makefile.am: s/testmodule.py/testsource.py/

Tue Feb  8 11:51:19 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/dirmonitor.py: ignore (End)Exists events since we scan
	  the tree ourselves, works only with gamin >= 0.0.23

2005-02-05  Seth Nickell  <seth@gnome.org>

	* lib/sources/mozillasource.py:
	If there's only one profile, its the default even if it 
	doesn't have the Default=1 flag. This makes mozillasource.py
	work on stock (to Fedora at least) Firefox installs,
	where the auto-generated profile doesn't have the Default=
	flag set.
	
2005-02-05  Seth Nickell  <seth@gnome.org>

	* admin-tool/sabayon.glade:

	Set list view scrollbar policy to auto.

2005-02-04  Frank Arnold  <farnold@cvs.gnome.org>

	* configure.ac: Added de to ALL_LINGUAS.

2005-02-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py: hook up edit to
	protosession.

2005-02-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py: make new and delete
	do stuff.

2005-02-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py,
	  admin-tool/sabayon.glade: add a "New Profile" dialog.

2005-02-03  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py: change things about a bit so that
	it creates its own temprary install directory.
	Add ProfileStorage::uninstall()
	Rename ProfileStorage::get_directory() to
	ProfileStorage::get_install_path()

	* admin-tool/monitorwindow.py,
	  admin-tool/sabayon.py,
	  lib/README.storage,
	  lib/protosession.py,
	  lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/userprofile.py: update for above change.
	
	* lib/sources/mozillasource.py: get_source() takes
	a ProfileStorage not profile_path

2005-02-03  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/profilesdialog.py: start implementing
	profiles manager dialog.
	
	* admin-tool/sabayon.glade: add profiles dialog.
	
	* lib/Makefile.am, lib/config.py.in: add some more
	variables.
	
	* lib/protosession.py: move some variables to config.py

2005-02-02  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: apply the profile before
	launching the session.
	
	* lib/storage.py: don't throw an exception if asked
	to install when the profile doesn't yet exist.
	
	* lib/userprofile.py: don't ignore exceptions from
	ProfileStorage.install()

2005-02-02  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage.py: test adding a new file after
	installing.

2005-02-02  Mark McLoughlin  <markmc@redhat.com>

	* README: add bit about bug #154779
	
	* lib/storage.py:
	(print_exception): remove, unused.
	(ProfileStorage.__init__): add directory to constructor.
	Doesn't make sense for it to default to the home directory.
	(ProfileStorage.__get_metadata_description): accessor
	for description.
	(ProfileStorage.__get_file_info): build the tuple to be
	returned from update_all(), info_all() and install()
	(ProfileStorage.__get_asb_filename): rename to
	__get_abs_filename()
	(ProfileStorage.update_all): allow for a file that was
	added after installation.
	(run_unit_tests): re-work so we don't use the home dir,
	not spew debugging, test things a bit more and crap out
	if something fails
	
	* lib/README.storage: update.
	
	* lib/sources/filessource.py: lots of fixing, commiting 
	and applying work now.
	
	* lib/sources/gconfsource.py: update for ProfileStorage
	changes.
	
	* lib/userprofile.py:
	(UserProfile.__init__): update for storage changes.
	(UserProfile.sync_changes): sync storage to disk.
	
	* lib/util.py:
	(set_home_dir_for_unit_tests): add to make writing
	unit tests easier.

2005-02-02  Mark McLoughlin  <markmc@redhat.com>

	* lib/unittests.py: over-engineer the test harness
	to make it easier to selectively run certain tests
	i.e. "./unittests.py util storage filessource" just
	runs those tests.

2005-02-01  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: launch the admin tool an
	arbtrary 5 seconds after starting the session.
	
	* lib/userprofile.py: allow the delegate not to
	emit any changes of its own.

2005-02-01  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: open the dummy X connection
	on the right display.

2005-01-31  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: open and hold open an X
	connection so Xnest doesn't re-init as xsetroot
	and xrdb connect and disconnect.

2005-01-31  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py:
	Explicitly write the protouser's xauth file since
	we need to change the display number.
	Use execve instead of changing os.environ.
	Add debugging spew.

2005-01-31  Mark McLoughlin  <markmc@redhat.com>

	* lib/dirmonitor.py: disconnect from gamin when
	stopping the monitor.

2005-01-31  Mark McLoughlin  <markmc@redhat.com>

	* lib/dirmonitor.py: remove all watches when
	stopping monitoring.

2005-01-31  Mark McLoughlin  <markmc@redhat.com>

	* lib/dirmonitor.py: fixup some bugs, passes unit
	tests again.

2005-01-29  Raphael Higino  <raphaelh@cvs.gnome.org>

	* configure.ac: Added pt_BR to ALL_LINGUAS.

2005-01-28  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: copy the xauth file for the user
	before starting the session.

2005-01-28  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: add code to write out an xauth
	file for Xnest.

Fri Jan 28 11:20:03 CET 2005 Daniel Veillard <veillard@redhat.com>

	* README lib/dirmonitor.py: switching to using gamin directly
	  for the directory watches.

2005-01-27  Mark McLoughlin  <markmc@redhat.com>

	* lib/protosession.py: checkpoint of the session
	launching code.

2005-01-27  Mark McLoughlin  <markmc@redhat.com>

	* lib/util.py: hmm, use GeneralError again.

2005-01-26  Mark McLoughlin  <markmc@redhat.com>

	* lib/util.py: pull username and homedir from
	the passwd database if available.

2005-01-25  Adam Weinberger  <adamw@gnome.org>

	* configure.ac: Added en_CA to ALL_LINGUAS.

2005-01-25  Mark McLoughlin  <markmc@redhat.com>

	* lib/userprofile.py: introduce the concept of a
	"delegate" - a helper class to give a higher level
	interpretation of some changes from a given source.
	
	* lib/sources/paneldelegate.py: an implementation
	of the helper class for the panel's config - so, e.g.,
	when you added an applet you get "applet added" rather
	than a whole bunch of GConf keys changed.
	
	* lib/sources/Makefile.am: add paneldelegate.py.
	
	* lib/sources/filessource.py,
	  lib/sources/gconfsource.py,
	  lib/sources/mozillasource.py: update.
	
	* lib/unittests.py,
	  lib/sources/testsource.py: hook up some more unit
	tests.
	
2005-01-24  Mark McLoughlin  <markmc@redhat.com>

	* lib/storage-modules/: rename to lib/sources -
	these modules are ProfileSource sub-classes, nothing
	to do with the ProfileStorage class - to avoid
	confusion.

	* configure.ac, lib/Makefile.am, lib/config.py.in
	  lib/unittests.py, lib/userprofile.py: update.

2005-01-24  Christian Rose  <menthos@menthos.com>

	* configure.ac: Added "sv" to ALL_LINGUAS.

Fri Jan 21 13:45:19 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/dirmonitor.py: do not explode when launched on a real user
	  environment.

Fri Jan 21 12:00:42 CET 2005 Daniel Veillard <veillard@redhat.com>

	* README: small update
	* lib/dirmonitor.py: try to fix problem with older gnome-vfs bindings

2005-01-21  Mark McLoughlin  <markmc@redhat.com>

	* lib/userprofile.py: last few bits of the grand re-naming.
	
	* lib/storage-modules/mozillasource.py: disable for now.

Thu Jan 20 21:44:31 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/dirmonitor.py: try to work around a portability problem
	  about gnome-vfs python module name
	* lib/util.py: added a routine print_exception() to display an exception

2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* lib/modules/gconfprofile.py: import errno module.

2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py: fix buglet.

2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/Makefile.am: install glade file
	in $pkgdatadir/glade, generate user-profile-admin.
	
	* admin-tool/user-profile-admin: remove.
	
	* admin-tool/user-profile-admin.in: add - generated
	now with correct prefix.
	
	* lib/Makefile.am: add some missing files, generate
	config.py.
	
	* lib/config.py: remove
	
	* lib/config.py.in: add - generates config.py.
	
	* lib/modules/Makefile.am: add filesprofile.py

Thu Jan 20 15:30:04 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/README.package lib/package.py: added a get_directory() entry point
	* admin-tool/monitorwindow.py admin-tool/user-profile-admin.py:
	  moving profile file intialization down to UserProfile() init
	* lib/userprofile.py lib/modules/filesprofile.py 
	  lib/modules/gconfprofile.py lib/modules/testmodule.py: adding the
	  self.profile_storage coming from the storage module, replacing
	  bascially self.profile_path by self.profile_storage.get_directory().
	  The modules creation routines now take a storage object argument
	  instead of a storage path.
	  
2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py: add a mandatory toggle,
	stop using magic numbers for column indices.

Thu Jan 20 13:32:28 CET 2005 Daniel Veillard <veillard@redhat.com>

	* admin-tool/user-profile-admin.py: use the package module instead of
	  tar files for the profile storage. Loading only ATM.

2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* admin-tool/monitorwindow.py:
	(ProfileChangesModel.handle_profile_change):
	remove existing changes to the same item from the model
	before prepending the new one.
	(ProfileMonitorWindow): hook up the menu items.
	
	* admin-tool/user-profile-admin.glade: add a "Commit"
	menu item.

2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* lib/modules/filesprofile.py: add "files" backend
	
	* lib/dirmonitor.py: remove the timeout when we've
	completed our tests so we don't screw over other
	tests.
	
	* lib/modules/gconfprofile.py: user util.get_home_dir()
	and util.get_user_name ()
	
	* lib/unittests.py: hook up more tests.

Thu Jan 20 11:28:50 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/package.py: GPL header
	* lib/config.py admin-tool/user-profile-admin: trying to get paths
	  to work automatically from CVS checkout too

Thu Jan 20 10:42:03 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/package.py: reuse util functions

2005-01-20  Mark McLoughlin  <markmc@redhat.com>

	* lib/util.py: add get_home_dir() and get_user_name()
	utility functions.

2005-01-19  Mark McLoughlin  <markmc@redhat.com>

	* lib/dirmonitor.py: add a recursive directory monitor
	thingy.

Wed Jan 19 11:36:57 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/README.package: quick doc for the package module

Wed Jan 19 11:15:04 CET 2005 Daniel Veillard <veillard@redhat.com>

	* lib/Makefile.am lib/package.py: integrated the package lib in the
	  tree

